<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9. Wrappers &mdash; sinergym  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/doc_theme.css?v=816ccb90" />

  
    <link rel="shortcut icon" href="../_static/logo-sidebar.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Extra Configuration in Sinergym simulations" href="extra-configuration.html" />
    <link rel="prev" title="8. Controllers" href="controllers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #a5beba" >

          
          
          <a href="../index.html" class="icon icon-home">
            sinergym
              <img src="../_static/logo-sidebar.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage-example.html">2. Usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">sinergym</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="buildings.html">3. Buildings</a></li>
<li class="toctree-l1"><a class="reference internal" href="weathers.html">4. Weathers</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">5. Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments_registration.html">6. Environments Configuration and Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">7. Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">8. Controllers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">9. Wrappers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#multiobjectivereward">9.1. MultiObjectiveReward</a></li>
<li class="toctree-l2"><a class="reference internal" href="#previousobservationwrapper">9.2. PreviousObservationWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datetimewrapper">9.3. DatetimeWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalizeaction">9.4. NormalizeAction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discretizeenv">9.5. DiscretizeEnv</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discreteincrementalwrapper">9.6. DiscreteIncrementalWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalizeobservation">9.7. NormalizeObservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loggerwrapper">9.8. LoggerWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiobswrapper">9.9. MultiObsWrapper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extra-configuration.html">10. Extra Configuration in Sinergym simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">11. Output format</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">12. Deep Reinforcement Learning Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="gcloudAPI.html">13. Sinergym with Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-actions.html">14. Github Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">15. Tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/basic_example.html">16. Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/getting_env_information.html">17. Getting information about Sinergym environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/change_environment.html">18. Changing an environment registered in Sinergym</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/default_building_control.html">19. Default building control setting up an empty action interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/wrappers_examples.html">20. Wrappers example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/personalize_loggerwrapper.html">21. Logger Wrapper personalization/configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/rule_controller_example.html">22. Rule Controller example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/drl.html">23. DRL usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API-reference.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #a5beba" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sinergym</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">9. </span>Wrappers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/wrappers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wrappers">
<h1><span class="section-number">9. </span>Wrappers<a class="headerlink" href="#wrappers" title="Link to this heading"></a></h1>
<p><em>Sinergym</em> has several <strong>wrappers</strong> in order to add some functionality in the environment
that it doesn’t have by default. The code can be found in
<a class="reference external" href="https://github.com/ugr-sail/sinergym/blob/main/sinergym/utils/wrappers.py">sinergym/sinergym/utils/wrappers.py</a>.
You can implement your own wrappers inheriting from <em>gym.Wrapper</em> or some of its variants, see
<a class="reference external" href="https://gymnasium.farama.org/tutorials/gymnasium_basics/implementing_custom_wrappers/">Gymnasium documentation</a>.</p>
<section id="multiobjectivereward">
<h2><span class="section-number">9.1. </span>MultiObjectiveReward<a class="headerlink" href="#multiobjectivereward" title="Link to this heading"></a></h2>
<p>Environment step will return a vector reward (selected elements in wrapper constructor,
one for each objective) instead of a traditional scalar value. See <a class="reference external" href="https://github.com/ugr-sail/sinergym/issues/301">#301</a>.</p>
</section>
<section id="previousobservationwrapper">
<h2><span class="section-number">9.2. </span>PreviousObservationWrapper<a class="headerlink" href="#previousobservationwrapper" title="Link to this heading"></a></h2>
<p>Wrapper to add observation values from previous timestep to current environment observation.
It is possible to select the variables you want to track its previous observation values.</p>
</section>
<section id="datetimewrapper">
<h2><span class="section-number">9.3. </span>DatetimeWrapper<a class="headerlink" href="#datetimewrapper" title="Link to this heading"></a></h2>
<p>Wrapper to substitute <code class="docutils literal notranslate"><span class="pre">day_of_month</span></code> value by <code class="docutils literal notranslate"><span class="pre">is_weekend</span></code> flag, and <code class="docutils literal notranslate"><span class="pre">hour</span></code> and <code class="docutils literal notranslate"><span class="pre">month</span></code> by sin and cos values.
Observation space is updated automatically.</p>
</section>
<section id="normalizeaction">
<h2><span class="section-number">9.4. </span>NormalizeAction<a class="headerlink" href="#normalizeaction" title="Link to this heading"></a></h2>
<p>Wrapper to apply normalization in action space. It is very useful in DRL algorithms such as some of them
only works with normalized values correctly, making environments more generic in DRL solutions.</p>
<p>By default, the normalization is applied in the range <code class="docutils literal notranslate"><span class="pre">[-1,1]</span></code>. However, other <strong>range</strong> can be specified when wrapper
is instantiated.</p>
<p><em>Sinergym</em> <strong>parse</strong> these values to real action space defined in original environment internally before to
send it to <em>EnergyPlus</em> Simulator by the API middleware.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The method in charge of parse this values from [-1,1] to real action space if it is required is
called <code class="docutils literal notranslate"><span class="pre">reverting_action(action)</span></code> in the wrapper class.
We always recommend to use the normalization in action space for DRL solutions, since this space is
compatible with all algorithms. However, if you are implementing your own rule-based controller
and working with real action values, for example, you don’t must to apply this wrapper.</p>
</div>
<a class="reference internal image-reference" href="../_images/normalize_action_wrapper.png"><img alt="Normalize action wrapper graph." class="align-center" src="../_images/normalize_action_wrapper.png" style="width: 752.0px; height: 551.0px;" /></a>
</section>
<section id="discretizeenv">
<h2><span class="section-number">9.5. </span>DiscretizeEnv<a class="headerlink" href="#discretizeenv" title="Link to this heading"></a></h2>
<p>Wrapper to discretize the action space. <strong>Discrete space</strong> must be defined following the Gymnasium standard. This space
should be <code class="docutils literal notranslate"><span class="pre">gym.spaces.Discrete</span></code>, <code class="docutils literal notranslate"><span class="pre">gym.spaces.MultiDiscrete</span></code> or <code class="docutils literal notranslate"><span class="pre">gym.spaces.MultiBinary</span></code>. An <strong>action mapping function</strong>
is also given, in order to map this/these value(s) into ones that fit the underlying continuous environment (before to send it to the simulator).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The discrete space <strong>must</strong> discretize the original continuous space. Therefore, discrete space only should reach values which
are considered in the original environment action space.</p>
</div>
<p>This action mapping function can be defined by users to specify how to jump from discrete to continuous values. If action mapping function
output doesn’t match with original environment action space, an error will be raised. See <a class="reference internal" href="notebooks/wrappers_examples.html#Environment-Discretization-Wrapper"><span class="std std-ref">Environment Discretization Wrapper</span></a> for an example of use.</p>
<a class="reference internal image-reference" href="../_images/discretize_wrapper.png"><img alt="Discretize wrapper graph." class="align-center" src="../_images/discretize_wrapper.png" style="width: 800.0px; height: 512.0px;" /></a>
</section>
<section id="discreteincrementalwrapper">
<h2><span class="section-number">9.6. </span>DiscreteIncrementalWrapper<a class="headerlink" href="#discreteincrementalwrapper" title="Link to this heading"></a></h2>
<p>A wrapper for an incremental setpoint action space environment. This wrapper
will update an environment, converting it in a <em>discrete</em> environment with an action mapping function and action space
depending on the <strong>step</strong> and <strong>delta</strong> specified. The action will be sum with <strong>current setpoint</strong> values instead of overwrite the latest action.
Then, the action is the current setpoint values with the increase instead of the discrete value action whose purpose is to define
the increment/decrement itself.</p>
<a class="reference internal image-reference" href="../_images/incremental_wrapper.png"><img alt="Incremental wrapper graph." class="align-center" src="../_images/incremental_wrapper.png" style="width: 850.0px; height: 570.0px;" /></a>
</section>
<section id="normalizeobservation">
<h2><span class="section-number">9.7. </span>NormalizeObservation<a class="headerlink" href="#normalizeobservation" title="Link to this heading"></a></h2>
<p>It is used to transform observation received from simulator in values between -1 and 1.
It is based in the <a class="reference external" href="https://gymnasium.farama.org/_modules/gymnasium/wrappers/normalize/#NormalizeObservation">dynamic normalization wrapper of Gymnasium</a>. At the beginning,
it is not precise and the values may be out of range usually, so use this wrapper carefully.</p>
</section>
<section id="loggerwrapper">
<h2><span class="section-number">9.8. </span>LoggerWrapper<a class="headerlink" href="#loggerwrapper" title="Link to this heading"></a></h2>
<p>Wrapper for logging all interactions between agent and environment. Logger class can be selected
in the constructor if other type of logging is required. For more information about <em>Sinergym</em> Logger visit <a class="reference internal" href="output.html#logger"><span class="std std-ref">Logger</span></a>.</p>
</section>
<section id="multiobswrapper">
<h2><span class="section-number">9.9. </span>MultiObsWrapper<a class="headerlink" href="#multiobswrapper" title="Link to this heading"></a></h2>
<p>Stack observation received in a history queue (size can be customized).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For examples about how to use these wrappers, visit <a class="reference internal" href="notebooks/wrappers_examples.html#Wrappers-example"><span class="std std-ref">Wrappers example</span></a>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You have to be careful if you are going to use several nested wrappers.
A wrapper works on top of the previous one. The order is flexible since <em>Sinergym</em> v3.0.5.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="controllers.html" class="btn btn-neutral float-left" title="8. Controllers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="extra-configuration.html" class="btn btn-neutral float-right" title="10. Extra Configuration in Sinergym simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, J. Jiménez, J. Gómez, M. Molina, A. Manjavacas, A. Campoy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v3.2.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../v1.4.0/pages/wrappers.html">v1.4.0</a></dd>
            <dd><a href="../../v1.6.0/pages/wrappers.html">v1.6.0</a></dd>
            <dd><a href="../../v1.7.0/pages/wrappers.html">v1.7.0</a></dd>
            <dd><a href="../../v2.0.0/pages/wrappers.html">v2.0.0</a></dd>
            <dd><a href="../../v2.1.0/pages/wrappers.html">v2.1.0</a></dd>
            <dd><a href="../../v2.2.0/pages/wrappers.html">v2.2.0</a></dd>
            <dd><a href="../../v2.3.0/pages/wrappers.html">v2.3.0</a></dd>
            <dd><a href="../../v2.5.0/pages/wrappers.html">v2.5.0</a></dd>
            <dd><a href="../../v3.1.0/pages/wrappers.html">v3.1.0</a></dd>
            <dd><a href="wrappers.html">v3.2.0</a></dd>
            <dd><a href="../../v3.2.10/pages/wrappers.html">v3.2.10</a></dd>
            <dd><a href="../../v3.3.0/pages/wrappers.html">v3.3.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../main/pages/wrappers.html">main</a></dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: #a5beba;
    }

    /* Sidebar */
    .wy-nav-side {
        background: #2b3435;
    }
</style>


</body>
</html>