<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Architecture &mdash; Sinergym  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/doc_theme.css?v=642ef2a8" />

  
    <link rel="shortcut icon" href="../_static/logo-sidebar.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Environments" href="environments.html" />
    <link rel="prev" title="Weathers" href="weathers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #a5beba" >

          
          
          <a href="../index.html" class="icon icon-home">
            Sinergym
              <img src="../_static/logo-sidebar.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage-example.html">Usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sinergym</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="buildings.html">Buildings</a></li>
<li class="toctree-l1"><a class="reference internal" href="weathers.html">Weathers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#additional-observation-information">Additional observation information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments_registration.html">Environments configuration and registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">Serialization and Configuration Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging system overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Sinergym output</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra-configuration.html">Extra configuration in Sinergym simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">Deep Reinforcement Learning integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="gcloudAPI.html">Google Cloud integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-actions.html">Github actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/basic_example.html">Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/getting_env_information.html">Getting information about Sinergym environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/sinergym_package.html">Sinergym package information</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/change_environment.html">Changing an environment registered in Sinergym</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/default_building_control.html">Default building control using an empty action space</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/wrappers_examples.html">Wrappers example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/personalize_loggerwrapper.html">LoggerWrapper customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/logging_unused_variables.html">Logging unused variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/rule_controller_example.html">Rule-based controller example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/drl.html">DRL usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API-reference.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #a5beba" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sinergym</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Architecture</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/architecture.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Link to this heading"></a></h1>
<p><em>Sinergym</em> is structured as follows:</p>
<a class="reference internal image-reference" href="../_images/sinergym_diagram.png"><img alt="*Sinergym* backend" class="align-center" src="../_images/sinergym_diagram.png" style="width: 800px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><em>Sinergym</em> is composed of three main components: the <em>agent</em>, the <em>communication interface</em>, and the <em>simulation</em>.
The agent interacts with the environment by sending actions and receiving observations through the Gymnasium interface.
Simultaneously, the Gymnasium interface establishes communication with the simulation engine using the <em>EnergyPlus</em> Python API.
This API enables the management of handlers such as variables, meters, and actuators, whose values directly impact the simulation’s execution.</p>
<p>The following image provides a detailed view of this process:</p>
<a class="reference internal image-reference" href="../_images/backend.png"><img alt="*Sinergym* backend" class="align-center" src="../_images/backend.png" style="width: 1600px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>During environment initialization (<code class="docutils literal notranslate"><span class="pre">__init__</span></code>), a building model is created using the specified epJSON file (<em>1</em>), and a simulator instance is instantiated (<em>2</em>), receiving the necessary data for its creation. Handlers for various components are initialized to facilitate the collection of information and control of the
simulation via the EnergyPlus Python API.</p>
<p>The next step involves initializing the first episode (<code class="docutils literal notranslate"><span class="pre">reset</span></code>), corresponding to the specified run period for the building. When a new episode begins, <em>Sinergym</em> utilizes its <a class="reference external" href="https://github.com/ugr-sail/sinergym/blob/main/sinergym/config/modeling.py">modeling</a> class to adapt the designated building and weather to the environment (<em>3</em>) and start the simulation (<em>4</em>). Key steps include:</p>
<ul class="simple">
<li><p><strong>Updating the EPW file</strong> if multiple files are used, randomly selecting one per episode (<em>3.1</em>).</p></li>
<li><p><strong>Introducing Output Variables and Output Meters</strong> specified in the environment into the building model (<em>3.2</em>).</p></li>
<li><p><strong>Adapting extra configurations</strong>, such as simulation timesteps per hour or the custom run period (<em>3.3</em>).</p></li>
<li><p><strong>Adjusting building attributes</strong> (e.g., altitude, latitude, and orientation) to align with the specified environment weather (<em>3.4</em>).</p></li>
<li><p><strong>Applying weather variability</strong>, if defined (<em>3.5</em>). This process involves adding random noise to the weather dataset to simulate varying weather conditions during each run period.</p></li>
</ul>
<p>Once the building model is configured, <em>Sinergym</em> executes the following steps for starting a simulation:</p>
<ul class="simple">
<li><p>Stops any ongoing simulation (<em>4.1</em>).</p></li>
<li><p>Generates the initial state (<em>4.2</em>).</p></li>
<li><p>Registers callbacks to interrupt the simulation for control flow (<em>4.3</em>).</p></li>
<li><p>Initiates the simulation process (<em>4.4</em>).</p></li>
<li><p>Executes the warmup process (<em>4.5</em>).</p></li>
</ul>
<p>When the simulation is ready, the agent begins sending control actions to the building (<em>5</em>). <em>Sinergym</em> replaces the building model’s predefined schedulers by interrupting the simulation, applying the agent’s actions, and resuming the process, thus enabling continuous control. The middleware coordinates this by waiting for the actions to take effect and the simulation state to update (<em>5.1</em>). Once updated, the new state is returned to the agent via the Gymnasium interface (<em>5.2</em>) and interaction continues via <code class="docutils literal notranslate"><span class="pre">step</span></code>. This cycle repeats until the episode concludes.</p>
<p>The tool is designed to handle additional tasks seamlessly, such as managing output directory structures, preparing handlers, and collecting data during simulation using callbacks. The <em>Sinergym</em> architecture achieves its design goals by providing several advantages:</p>
<ul class="simple">
<li><p><strong>Extensibility</strong>. Support to custom reward functions, wrappers, controllers, and loggers, as well as new EnergyPlus building and weather configurations.</p></li>
<li><p><strong>Comprehensive middleware</strong>. The EnergyPlus API grants access to all building sensors, metrics, actuators, and related simulation data.</p></li>
<li><p><strong>User-Friendly abstraction</strong>. The framework abstracts away the complexities of simulator interaction, allowing users to focus on data generation, learning control strategies, and validation.</p></li>
</ul>
<section id="additional-observation-information">
<h2>Additional observation information<a class="headerlink" href="#additional-observation-information" title="Link to this heading"></a></h2>
<p>In addition to the observations returned by the <code class="docutils literal notranslate"><span class="pre">step</span></code> and <code class="docutils literal notranslate"><span class="pre">reset</span></code> methods, as illustrated in the preceding images, both methods also provide a Python dictionary containing supplementary information:</p>
<ul class="simple">
<li><p><em>reset</em> info. This dictionary contains the following keys:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;time_elapsed(hours)&#39;</span><span class="p">:</span> <span class="c1"># &lt;Simulation time elapsed (in hours)&gt;,</span>
  <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="c1"># &lt;Month in which the episode starts.&gt;,</span>
  <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="c1"># &lt;Day in which the episode starts.&gt;,</span>
  <span class="s1">&#39;hour&#39;</span><span class="p">:</span> <span class="c1"># &lt;Hour in which the episode starts.&gt;,</span>
  <span class="s1">&#39;is_raining&#39;</span><span class="p">:</span> <span class="c1"># &lt;True if it is raining in the simulation.&gt;,</span>
  <span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="c1"># &lt;Timesteps count.&gt;,</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>step</em> info. This dictionary shares the same keys as the <em>reset</em> info, but also includes
the action dispatched (to the simulation, not the environment), the reward, and the reward terms, which depend on the reward function employed. For more details, refer to <a class="reference internal" href="rewards.html#reward-terms"><span class="std std-ref">Reward terms</span></a>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="weathers.html" class="btn btn-neutral float-left" title="Weathers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="environments.html" class="btn btn-neutral float-right" title="Environments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, J. Jiménez, J. Gómez, M. Molina, A. Manjavacas, A. Campoy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: main
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../v1.4.0/index.html">v1.4.0</a></dd>
            <dd><a href="../../v1.6.0/index.html">v1.6.0</a></dd>
            <dd><a href="../../v1.7.0/index.html">v1.7.0</a></dd>
            <dd><a href="../../v2.0.0/index.html">v2.0.0</a></dd>
            <dd><a href="../../v2.1.0/index.html">v2.1.0</a></dd>
            <dd><a href="../../v2.2.0/index.html">v2.2.0</a></dd>
            <dd><a href="../../v2.3.0/index.html">v2.3.0</a></dd>
            <dd><a href="../../v2.5.0/index.html">v2.5.0</a></dd>
            <dd><a href="../../v3.1.0/index.html">v3.1.0</a></dd>
            <dd><a href="../../v3.2.0/index.html">v3.2.0</a></dd>
            <dd><a href="../../v3.3.0/pages/architecture.html">v3.3.0</a></dd>
            <dd><a href="../../v3.4.0/pages/architecture.html">v3.4.0</a></dd>
            <dd><a href="../../v3.5.0/pages/architecture.html">v3.5.0</a></dd>
            <dd><a href="../../v3.6.0/pages/architecture.html">v3.6.0</a></dd>
            <dd><a href="../../v3.7.0/pages/architecture.html">v3.7.0</a></dd>
            <dd><a href="../../v3.8.0/pages/architecture.html">v3.8.0</a></dd>
            <dd><a href="../../v3.9.0/pages/architecture.html">v3.9.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="architecture.html">main</a></dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: #a5beba;
    }

    /* Sidebar */
    .wy-nav-side {
        background: #2b3435;
    }
</style>


</body>
</html>