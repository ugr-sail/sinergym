

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Serialization and Configuration Management &mdash; Sinergym  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/doc_theme.css?v=23b407c1" />
      <link rel="stylesheet" type="text/css" href="../_static/github_style.css?v=0a3c596a" />

  
    <link rel="shortcut icon" href="../_static/logo-sidebar.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Logging system overview" href="logging.html" />
    <link rel="prev" title="Environments configuration and registration" href="environments_registration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #a5beba" >

          
          
          <a href="../index.html" class="icon icon-home">
            Sinergym
              <img src="../_static/logo-sidebar.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage-example.html">Usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sinergym</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="buildings.html">Buildings</a></li>
<li class="toctree-l1"><a class="reference internal" href="weathers.html">Weathers</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments_registration.html">Environments configuration and registration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Serialization and Configuration Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#environment-configuration-serialization">Environment Configuration Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wrapper-serialization-and-restoration">Wrapper Serialization and Restoration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-serialization-and-restoration">Example: Serialization and Restoration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging system overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Sinergym output</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra-configuration.html">Extra configuration in Sinergym simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">Deep Reinforcement Learning integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="gcloudAPI.html">Google Cloud integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="github-actions.html">Github actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/basic_example.html">Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/getting_env_information.html">Getting information about Sinergym environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/sinergym_package.html">Sinergym package information</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/change_environment.html">Changing an environment registered in Sinergym</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/default_building_control.html">Default building control using an empty action space</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/wrappers_examples.html">Wrappers example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/personalize_loggerwrapper.html">LoggerWrapper customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/logging_unused_variables.html">Logging unused variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/rule_controller_example.html">Rule-based controller example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/drl.html">DRL usage example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API-reference.html">API reference</a></li>
</ul>

  <div class="sidebar-block github-block">
    <h3><i class="fa fa-github"></i> GitHub</h3>
    <ul class="simple">
      <li><a href="https://github.com/ugr-sail/sinergym" target="_blank">
        <i class="fa fa-book"></i> Repository
      </a></li>
      <li><a href="https://github.com/ugr-sail/sinergym/issues" target="_blank">üêû Issues</a></li>
      <li><a href="https://github.com/ugr-sail/sinergym/releases" target="_blank">üöÄ Releases</a></li>
    </ul>
  </div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #a5beba" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sinergym</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Serialization and Configuration Management</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ugr-sail/sinergym/blob/main/docs/source/pages/serialization.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="serialization-and-configuration-management">
<h1>Serialization and Configuration Management<a class="headerlink" href="#serialization-and-configuration-management" title="Link to this heading">ÔÉÅ</a></h1>
<p>In addition to initializing environments using predefined identifiers, Sinergym supports saving and restoring complete environment configurations through the <code class="docutils literal notranslate"><span class="pre">to_dict</span></code> and <code class="docutils literal notranslate"><span class="pre">from_dict</span></code> methods. This functionality allows users to export, modify, and reload environment setups with ease, thereby promoting reproducibility and simplifying the sharing of experimental configurations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="c1"># Save as YAML or reuse directly</span>
<span class="n">new_env</span> <span class="o">=</span> <span class="n">EplusEnv</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p>Although this method allows configuration persistence, serializing a Sinergym environment is not a trivial task. The environment may contain nested components, such as custom wrappers or references to complex objects, which are not easily expressed using basic data types.</p>
<p>To address this, Sinergym includes a dedicated serialization module (<code class="docutils literal notranslate"><span class="pre">sinergym.utils.serialization</span></code>) that leverages <strong>PyYAML</strong> to enable robust serialization and deserialization of both the environment and its associated wrappers. This module automates the transformation of complex Python objects into a YAML-compatible format, facilitating the saving and restoration of complete environment states.</p>
<section id="environment-configuration-serialization">
<h2>Environment Configuration Serialization<a class="headerlink" href="#environment-configuration-serialization" title="Link to this heading">ÔÉÅ</a></h2>
<p>When a Sinergym environment is instantiated, its configuration is automatically serialized and saved as a YAML file (<code class="docutils literal notranslate"><span class="pre">env_config.pyyaml</span></code>) within the environment‚Äôs designated output folder. This behavior ensures that every experiment includes a traceable and reproducible environment setup by default, even when the environment has been modified using user-specific configurations.</p>
</section>
<section id="wrapper-serialization-and-restoration">
<h2>Wrapper Serialization and Restoration<a class="headerlink" href="#wrapper-serialization-and-restoration" title="Link to this heading">ÔÉÅ</a></h2>
<p>Wrappers applied to an environment are not included in the default environment serialization and must be handled separately. Sinergym provides two utility functions for this purpose:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_wrappers_info</span></code>: Extracts metadata from all applied wrappers and serializes it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apply_wrappers_info</span></code>: Reconstructs and reapplies wrappers based on previously saved metadata.</p></li>
</ul>
</section>
<section id="example-serialization-and-restoration">
<h2>Example: Serialization and Restoration<a class="headerlink" href="#example-serialization-and-restoration" title="Link to this heading">ÔÉÅ</a></h2>
<p>Wrapper configurations are not automatically serialized like the environment configuration. To save and restore wrapper configurations, you need to manually serialize the wrapper information and then apply it when loading the environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gymnasium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gym</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sinergym.utils.common</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_wrappers_info</span><span class="p">,</span> <span class="n">apply_wrappers_info</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sinergym.utils.wrappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NormalizeObservation</span><span class="p">,</span> <span class="n">NormalizeAction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sinergym.envs.eplus_env</span><span class="w"> </span><span class="kn">import</span> <span class="n">EplusEnv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="c1"># Environment creation and wrapping</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Eplus-5zone-hot-continuous-stochastic-v1&#39;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">NormalizeObservation</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">NormalizeAction</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="c1"># Serialize wrapper information</span>
<span class="c1"># By default, this will be saved in the environment&#39;s output directory</span>
<span class="n">wrappers_info</span> <span class="o">=</span> <span class="n">get_wrappers_info</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, if no save path is specified, the wrapper configuration will be stored as <code class="docutils literal notranslate"><span class="pre">wrappers_config.pyyaml</span></code> in the environment‚Äôs output folder (accessible via <code class="docutils literal notranslate"><span class="pre">env.get_wrapper_attr('workspace_path')</span></code>).</p>
<p>To reload a complete environment, including its wrappers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load environment parameters</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;&lt;env_output_folder&gt;/env_config.pyyaml&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">env_params</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>

<span class="c1"># Modify environment parameters if needed...</span>

<span class="c1"># Restore environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">EplusEnv</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>

<span class="c1"># Restore wrappers (from file or dictionary)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">apply_wrappers_info</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s1">&#39;&lt;env_output_folder&gt;/wrappers_config.pyyaml&#39;</span><span class="p">)</span>
<span class="c1"># Alternatively:</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">apply_wrappers_info</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">wrappers_info</span><span class="p">)</span>
</pre></div>
</div>
<p>This feature is used in Sinergym‚Äôs scripts in <a class="reference internal" href="deep-reinforcement-learning.html#usage"><span class="std std-ref">Usage</span></a>.</p>
</section>
<section id="key-features">
<h2>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">ÔÉÅ</a></h2>
<ul class="simple">
<li><p><strong>Automatic environment serialization</strong> on initialization (saved as <code class="docutils literal notranslate"><span class="pre">env_config.pyyaml</span></code>).</p></li>
<li><p><strong>Wrapper metadata extraction and persistence</strong> via <code class="docutils literal notranslate"><span class="pre">get_wrappers_info</span></code>.</p></li>
<li><p><strong>Flexible restoration</strong>: Wrapper configurations can be reapplied using either a YAML file path or a Python dictionary.</p></li>
<li><p><strong>Default paths</strong>: If no path is provided, serialization files are stored in the environment‚Äôs output folder.</p></li>
<li><p><strong>Experiment reproducibility</strong>: Facilitates the sharing and exact reproduction of complex experimental setups.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="environments_registration.html" class="btn btn-neutral float-left" title="Environments configuration and registration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="logging.html" class="btn btn-neutral float-right" title="Logging system overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, J. Jim√©nez, J. G√≥mez, M. Molina, A. Manjavacas, A. Campoy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: main
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../v1.4.0/index.html">v1.4.0</a></dd>
            <dd><a href="../../v1.6.0/index.html">v1.6.0</a></dd>
            <dd><a href="../../v1.7.0/index.html">v1.7.0</a></dd>
            <dd><a href="../../v2.0.0/index.html">v2.0.0</a></dd>
            <dd><a href="../../v2.1.0/index.html">v2.1.0</a></dd>
            <dd><a href="../../v2.2.0/index.html">v2.2.0</a></dd>
            <dd><a href="../../v2.3.0/index.html">v2.3.0</a></dd>
            <dd><a href="../../v2.5.0/index.html">v2.5.0</a></dd>
            <dd><a href="../../v3.1.0/index.html">v3.1.0</a></dd>
            <dd><a href="../../v3.10.0/pages/serialization.html">v3.10.0</a></dd>
            <dd><a href="../../v3.2.0/index.html">v3.2.0</a></dd>
            <dd><a href="../../v3.3.0/index.html">v3.3.0</a></dd>
            <dd><a href="../../v3.4.0/index.html">v3.4.0</a></dd>
            <dd><a href="../../v3.5.0/index.html">v3.5.0</a></dd>
            <dd><a href="../../v3.6.0/index.html">v3.6.0</a></dd>
            <dd><a href="../../v3.7.0/index.html">v3.7.0</a></dd>
            <dd><a href="../../v3.8.0/index.html">v3.8.0</a></dd>
            <dd><a href="../../v3.9.0/pages/serialization.html">v3.9.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="serialization.html">main</a></dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>