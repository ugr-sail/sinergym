# Documentation: https://ugr-sail.github.io/sinergym/compilation/main/pages/environments_registration.html
# ---------------------------------------------------------------------------- #
#                        ID BASE FROM ENVIRONMNET NAMES                        #
# ---------------------------------------------------------------------------- #
id_base: radiant_case1_heating

# ---------------------------------------------------------------------------- #
#                         BUILDING AND WEATHER SETTINGS                        #
# ---------------------------------------------------------------------------- #
building_file: radiant_residential_building_hp_heating.epJSON

weather_specification:
  weather_files:
    - USA_AZ_Davis-Monthan.AFB.722745_TMY3.epw
    - USA_NY_New.York-J.F.Kennedy.Intl.AP.744860_TMY3.epw
    - USA_WA_Port.Angeles-William.R.Fairchild.Intl.AP.727885_TMY3.epw
    - SWE_Stockholm.Arlanda.024600_IWEC.epw
  weather_confs:
    - cap_nom_heating: 1000
      cap_nom_cooling: 100
      window_type: double_pane_low_E_air_eu
      thickness_roof: 0.15
      thickness_wall: 0.1
      setpoint_control_type: ZeroFlowPower
      heating_control_throttling_range: 0.5
      cooling_control_throttling_range: 1
      maximum_hot_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
      maximum_cold_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
    - cap_nom_heating: 2000
      cap_nom_cooling: 200
      window_type: double_pane_low_E_air_eu
      thickness_roof: 0.15
      thickness_wall: 0.1
      setpoint_control_type: ZeroFlowPower
      heating_control_throttling_range: 0.5
      cooling_control_throttling_range: 1
      maximum_hot_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
      maximum_cold_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
    - cap_nom_heating: 3000
      cap_nom_cooling: 300
      window_type: double_pane_low_E_air_eu
      thickness_roof: 0.15
      thickness_wall: 0.1
      setpoint_control_type: ZeroFlowPower
      heating_control_throttling_range: 0.5
      cooling_control_throttling_range: 1
      maximum_hot_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
      maximum_cold_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
    - cap_nom_heating: 7000
      cap_nom_cooling: Autosize
      window_type: double_pane_low_E_air_eu
      thickness_roof: 0.05
      thickness_wall: 0.05
      setpoint_control_type: ZeroFlowPower
      heating_control_throttling_range: 0.5
      cooling_control_throttling_range: 1
      maximum_hot_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
      maximum_cold_water_flow: ['Autosize', 'Autosize', 'Autosize', 'Autosize', 'Autosize']
  keys: [hot, mixed, cool, stockholm]

# ---------------------------------------------------------------------------- #
#                         BUILDING EXTRA CONFIGURATION                         #
# ---------------------------------------------------------------------------- #
building_config:
  timesteps_per_hour: 2
  north_axis: 270.0

# ---------------------------------------------------------------------------- #
#                        WEATHER VARIABILITY (OPTIONAL)                        #
# ---------------------------------------------------------------------------- #
# Alternative stochastic environments if it is defined
weather_variability:
  Dry Bulb Temperature:
    - [0.0, 2.0]
    - 0.0
    - 24.0
    - [-40.0, 40.0]
  Relative Humidity:
    - [0.0, 5.0]
    - 0.0
    - 24.0
    - [0.0, 100.0]
  Wind Speed:
    - [0.0, 5.0]    
    - 0.0
    - 24.0
    - [0.0, 20.0]
  Wind Direction:
    - [0.0, 45.0]
    - 0.0
    - 24.0
    - [0.0, 360.0]
  Direct Normal Radiation:
    - [0.0, 80.0]
    - 0.0
    - 24.0
    - [0.0, 1000.0]
  Diffuse Horizontal Radiation:
    - [0.0, 30.0]
    - 0.0
    - 24.0
    - [0.0, 400.0]

# ---------------------------------------------------------------------------- #
#                          EPISODES FOLDER GENERATION                          #
# ---------------------------------------------------------------------------- #
max_ep_store: 3

# ---------------------------------------------------------------------------- #
#                             OBSERVATION VARIABLES                            #
# ---------------------------------------------------------------------------- #

# --------------- TIME VARIABLES (same name as EnergyPlus API) --------------- #
time_variables:
  - month
  - day_of_month
  - hour
  # More variables in Data Transfer API: https://energyplus.readthedocs.io/en/latest/datatransfer.html

# ----------------------------- OUTPUT:VARIABLES ----------------------------- #
variables:

  # ---------------------------------- OUTDOOR --------------------------------- #
  Site Outdoor Air DryBulb Temperature:
    variable_names: outdoor_temperature
    keys: Environment
  Site Outdoor Air Relative Humidity:
    variable_names: outdoor_humidity
    keys: Environment
  Site Wind Speed:
    variable_names: wind_speed
    keys: Environment
  Site Wind Direction:
    variable_names: wind_direction
    keys: Environment
  Site Diffuse Solar Radiation Rate per Area:
    variable_names: diffuse_solar_radiation
    keys: Environment
  Site Direct Solar Radiation Rate per Area:
    variable_names: direct_solar_radiation
    keys: Environment

  # -------------------------------- ZONE INDOOR ------------------------------- #
  Zone Air Temperature:
    variable_names:
      - air_temperature_living
      - air_temperature_kitchen
      - air_temperature_bed1
      - air_temperature_bed2
      - air_temperature_bed3
    keys:
      - FirstFloor:LivingRoom
      - FirstFloor:Kitchen
      - SecondFloor:Bedroom01
      - SecondFloor:Bedroom02
      - SecondFloor:Bedroom03
  Zone Air Relative Humidity:
    variable_names:
      - air_humidity_living
      - air_humidity_kitchen
      - air_humidity_bed1
      - air_humidity_bed2
      - air_humidity_bed3
    keys:
      - FirstFloor:LivingRoom
      - FirstFloor:Kitchen
      - SecondFloor:Bedroom01
      - SecondFloor:Bedroom02
      - SecondFloor:Bedroom03

  # ---------------------------------- SYSTEM ---------------------------------- #
  Zone Thermostat Heating Setpoint Temperature:
    variable_names:
      - heating_setpoint_living
      - heating_setpoint_kitchen
      - heating_setpoint_bed1
      - heating_setpoint_bed2
      - heating_setpoint_bed3
    keys:
      - FirstFloor:LivingRoom
      - FirstFloor:Kitchen
      - SecondFloor:Bedroom01
      - SecondFloor:Bedroom02
      - SecondFloor:Bedroom03
  Zone Radiant HVAC Outlet Temperature:
    variable_names:
      - radiant_hvac_outlet_temperature_living
      - radiant_hvac_outlet_temperature_kitchen
      - radiant_hvac_outlet_temperature_bed1
      - radiant_hvac_outlet_temperature_bed2
      - radiant_hvac_outlet_temperature_bed3
    keys:
      - FirstFloor:LivingRoom radiant surface
      - FirstFloor:Kitchen radiant surface
      - SecondFloor:Bedroom01 radiant surface
      - SecondFloor:Bedroom02 radiant surface
      - SecondFloor:Bedroom03 radiant surface
  System Node Setpoint Temperature:
    variable_names: water_temperature
    keys: HW Loop Supply Side Outlet
  System Node Mass Flow Rate:
    variable_names:
      - flow_rate_living
      - flow_rate_kitchen
      - flow_rate_bed1
      - flow_rate_bed2
      - flow_rate_bed3
    keys:
      - FirstFloor:LivingRoom Radiant surface Hot Water Inlet Node
      - FirstFloor:Kitchen Radiant surface Hot Water Inlet Node
      - SecondFloor:Bedroom01 Radiant surface Hot Water Inlet Node
      - SecondFloor:Bedroom02 Radiant surface Hot Water Inlet Node
      - SecondFloor:Bedroom03 Radiant surface Hot Water Inlet Node
  Heat Pump Load Side Outlet Temperature:
    variable_names: heat_source_load_side_outlet_temp
    keys: Heating Temp. Source
  Heat Pump Load Side Inlet Temperature:
    variable_names: heat_source_load_side_inlet_temp
    keys: Heating Temp. Source
  Heat Pump Load Side Heat Transfer Rate:
    variable_names: heat_source_load_side_heat_transfer_rate
    keys: Heating Temp. Source
  Heat Pump Load Side Mass Flow Rate:
    variable_names: heat_source_load_side_mass_flow_rate
    keys: Heating Temp. Source
  Heat Pump Cycling Ratio:
    variable_names: crf
    keys: Heating Temp. Source
  Performance Curve Output Value:
    variable_names:
      - heat_cap_mod
      - cop_plr_mod
      - cop_temp_mod
    keys:
      - HEATCAPAQUAREA9KW
      - AQUAREA9KW_PLR
      - COPAQUAREA9KW
  Heat Pump Part Load Ratio:
    variable_names: plr_current
    keys: Heating Temp. Source

  # ---------------------------------- ENERGY ---------------------------------- #
  Heat Pump Electricity Rate:
    variable_names: heat_source_electricity_rate
    keys: Heating Temp. Source

# ------------------------------- OUTPUT:METERS ------------------------------ #
meters: {}

# ---------------------------------------------------------------------------- #
#                               ACTION VARIABLES                               #
# ---------------------------------------------------------------------------- #

# --------------------------- ACTUATORS TO CONTROL --------------------------- #
actuators:
  'HEATING HIGH WATER TEMPERATURE SCHEDULE: ALWAYS 65.00':
    variable_name: water_temperature
    element_type: Schedule:Compact
    value_type: Schedule Value

# ---------------------------------------------------------------------------- #
#                   DYNAMIC CONTEXT CONFIGURABLE IN REAL-TIME                  #
# ---------------------------------------------------------------------------- #
context:
  Heating SP LIVING_SCHED:
    variable_name: heating_setpoint_living
    element_type: Schedule:Compact
    value_type: Schedule Value
  Heating SP KITCHEN_SCHED:
    variable_name: heating_setpoint_kitchen
    element_type: Schedule:Compact
    value_type: Schedule Value
  Heating SP BEDROOM1_SCHED:
    variable_name: heating_setpoint_bed1
    element_type: Schedule:Compact
    value_type: Schedule Value
  Heating SP BEDROOM2_SCHED:
    variable_name: heating_setpoint_bed2
    element_type: Schedule:Compact
    value_type: Schedule Value
  Heating SP BEDROOM3_SCHED:
    variable_name: heating_setpoint_bed3
    element_type: Schedule:Compact
    value_type: Schedule Value

initial_context:
  - 20
  - 20
  - 20
  - 20
  - 20

# ---------------------------------------------------------------------------- #
#                                 ACTIONS SPACE                                #
# ---------------------------------------------------------------------------- #
action_space: gym.spaces.Box(low=np.array([25.0], dtype=np.float32), high=np.array([45.0], dtype=np.float32), shape=(1,), dtype=np.float32)

only_discrete: false

# ---------------------------------------------------------------------------- #
#                                REWARD FUNCTION                               #
# ---------------------------------------------------------------------------- #
reward: sinergym.utils.rewards:LinearReward

reward_kwargs:
  temperature_variables:
    - air_temperature_living
    - air_temperature_kitchen
    - air_temperature_bed1
    - air_temperature_bed2
    - air_temperature_bed3
  energy_variables:
    - heat_source_electricity_rate
  range_comfort_winter:
    - 19.5
    - 22
  range_comfort_summer:
    - 19.5
    - 22
  summer_start:
    - 6
    - 1
  summer_final:
    - 9
    - 30
  energy_weight: 0.5
  lambda_energy: 0.001
  lambda_temperature: 1