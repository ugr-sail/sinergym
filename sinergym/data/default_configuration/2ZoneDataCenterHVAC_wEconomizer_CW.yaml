# Documentation: https://ugr-sail.github.io/sinergym/compilation/main/pages/environments_registration.html
# ---------------------------------------------------------------------------- #
#                        ID BASE FROM ENVIRONMNET NAMES                        #
# ---------------------------------------------------------------------------- #
id_base: datacenter_cw

# ---------------------------------------------------------------------------- #
#                         BUILDING AND WEATHER SETTINGS                        #
# ---------------------------------------------------------------------------- #
building_file: 2ZoneDataCenterHVAC_wEconomizer_CW.epJSON

# A environment alternative for each weather key
weather_specification:
  weather_files:
    - USA_IL_Chicago-OHare.Intl.AP.725300_TMY3.epw
    - USA_AZ_Davis-Monthan.AFB.722745_TMY3.epw
    - USA_NY_New.York-J.F.Kennedy.Intl.AP.744860_TMY3.epw
    - USA_WA_Port.Angeles-William.R.Fairchild.Intl.AP.727885_TMY3.epw
  keys:
    - chicago
    - hot
    - mixed
    - cool

# ---------------------------------------------------------------------------- #
#                         BUILDING EXTRA CONFIGURATION                         #
# ---------------------------------------------------------------------------- #
building_config:
  timesteps_per_hour: 6

# ---------------------------------------------------------------------------- #
#                        WEATHER VARIABILITY (OPTIONAL)                        #
# ---------------------------------------------------------------------------- #
# Alternative stochastic environments if it is defined
weather_variability:
  Dry Bulb Temperature:
    - 1.0 # sigma
    - 0.0 # mu
    - 24.0 # tau
  Relative Humidity:
    - [2.0, 5.0]
    - 0.0
    - 24.0
    - [0, 100] # var_range
# ---------------------------------------------------------------------------- #
#                          EPISODES FOLDER GENERATION                          #
# ---------------------------------------------------------------------------- #
max_ep_store: 3

# ---------------------------------------------------------------------------- #
#                             OBSERVATION VARIABLES                            #
# ---------------------------------------------------------------------------- #

# --------------- TIME VARIABLES (same name as EnergyPlus API) --------------- #
time_variables:
  - month
  - day_of_month
  - hour
# More variables in Data Transfer API: https://energyplus.readthedocs.io/en/latest/datatransfer.html

# ----------------------------- OUTPUT:VARIABLES ----------------------------- #
variables:
  # ---------------------------------- OUTDOOR --------------------------------- #
  Site Outdoor Air Drybulb Temperature:
    variable_names: outdoor_temperature
    keys: Environment
  Site Outdoor Air Relative Humidity:
    variable_names: outdoor_humidity
    keys: Environment
  Site Wind Speed:
    variable_names: wind_speed
    keys: Environment
  Site Wind Direction:
    variable_names: wind_direction
    keys: Environment
  Site Diffuse Solar Radiation Rate per Area:
    variable_names: diffuse_solar_radiation
    keys: Environment
  Site Direct Solar Radiation Rate per Area:
    variable_names: direct_solar_radiation
    keys: Environment

  # -------------------------------- ZONE INDOOR ------------------------------- #
  Zone Air Temperature:
    variable_names: air_temperature
    keys:
      - East Zone
      - West Zone
  Zone Mean Radiant Temperature:
    variable_names: mean_radiant_temperature
    keys:
      - East Zone
      - West Zone
  Zone Air Relative Humidity:
    variable_names: air_humidity
    keys:
      - East Zone
      - West Zone

  # ---------------------------------- SYSTEM ---------------------------------- #
  Zone Thermostat Cooling Setpoint Temperature:
    variable_names: clg_setpoint
    keys: East Zone
      # keys:
      #   - East Zone
      #   - West Zone
  System Node Temperature:
    variable_names:
      - east_return_temperature
      - east_supply_temperature
      - west_return_temperature
      - west_supply_temperature
    keys:
      - East Zone Return Air Node
      - East Air Loop Outlet Node
      - West Zone Return Air Node
      - West Air Loop Outlet Node
      # - East Zone CCoil Air Outlet Node
      # - West Zone CCoil Air Outlet Node
      # - East Zone Mixed Air Node
      # - West Zone Mixed Air Node
  System Node Mass Flow Rate:
    variable_names: 
      - east_mass_flow_rate
      - west_mass_flow_rate
    keys:
      - East Zone Inlet Node
      - West Zone Inlet Node
      # - East Zone CCoil Air Outlet Node
      # - West Zone CCoil Air Outlet Node
  Chiller Evaporator Inlet Temperature:
    variable_names: chws_return_temperature
    keys: Chiller
  Chiller Evaporator Outlet Temperature:
    variable_names: chws_supply_temperature
    keys: Chiller
  Cooling Coil Total Cooling Rate:
    variable_names: 
      - east_cw_total_cooling_rate
      - west_cw_total_cooling_rate
    keys:
      - East Zone CW Cooling Coil
      - West Zone CW Cooling Coil
  Cooling Coil Sensible Cooling Rate:
    variable_names: 
      - east_cw_sensible_cooling_rate
      - west_cw_sensible_cooling_rate
    keys:
      - East Zone CW Cooling Coil
      - West Zone CW Cooling Coil
  Performance Curve Input Variable 1 Value:
    variable_names: cpu_loading_fraction
    keys: Data Center Servers Power fLoadTemp

  # ---------------------------------- ENERGY ---------------------------------- #
  Evaporative Cooler Electricity Rate:
    variable_names: 
      - east_dec_electricity_rate
      - east_iec_electricity_rate
      - west_dec_electricity_rate
      - west_iec_electricity_rate
    keys:
      - East Data Center DEC
      - East Data Center IEC
      - West Data Center DEC
      - West Data Center IEC
  Chiller Electricity Rate:
    variable_names: chiller_electricity_rate
    keys: Chiller
  Pump Electricity Rate:
    variable_names: 
      - cw_pump_electricity_rate
      - condenser_pump_electricity_rate
    keys:
      - CW Circ Pump
      - Cond Circ Pump
  Fan Electricity Rate:
    variable_names: 
      - east_fan_electricity_rate
      - west_fan_electricity_rate
    keys: 
      - East Zone Supply Fan
      - West Zone Supply Fan
  Cooling Tower Fan Electricity Rate:
    variable_names: cooling_tower_fan_electricity_rate
    keys: Cooling Tower
  Cooling Tower Basin Heater Electricity Rate:
    variable_names: cooling_tower_basin_heater_electricity_rate
    keys: Cooling Tower
  # Cooling Coil Crankcase Heater Electricity Rate:
  #   variable_names:
  #     - east_dx_crankcase_heater_electricity_rate
  #     - west_dx_crankcase_heater_electricity_rate
  #   keys:
  #     - East DX Cooling Coil
  #     - West DX Cooling Coil
  # Zone ITE CPU Electricity Rate:
  #   variable_names: cpu_demand_rate
  #   keys: 
  #     - East Zone
  #     - West Zone
  Facility Total HVAC Electricity Demand Rate:
    variable_names: HVAC_electricity_demand_rate
    keys: Whole Building

# ------------------------------- OUTPUT:METERS ------------------------------ #
meters: {}

# ---------------------------------------------------------------------------- #
#                               ACTION VARIABLES                               #
# ---------------------------------------------------------------------------- #

# --------------------------- ACTUATORS TO CONTROL --------------------------- #
actuators:
  Cooling Setpoints:
    variable_name: cooling_setpoint
    element_type: Schedule:Compact
    value_type: Schedule Value
  CW Loop Temp Schedule:
    variable_name: chiller_water_temperature
    element_type: Schedule:Compact
    value_type: Schedule Value
  

# ---------------------------------------------------------------------------- #
#                   DYNAMIC CONTEXT CONFIGURABLE IN REAL-TIME                  #
# ---------------------------------------------------------------------------- #
context: {}

# ---------------------------------------------------------------------------- #
#                                 ACTIONS SPACE                                #
# ---------------------------------------------------------------------------- #
action_space: gym.spaces.Box(low=np.array([20.0, 5.0], dtype=np.float32), high=np.array([30.0, 10.0], dtype=np.float32), shape=(2,), dtype=np.float32)

action_space_discrete: gym.spaces.Discrete(10)

# ---------------------------------------------------------------------------- #
#                                REWARD FUNCTION                               #
# ---------------------------------------------------------------------------- #
reward: sinergym.utils.rewards:BalancedRewardV1

reward_kwargs:
  temperature_variables:
    - west_zone_air_temperature
  energy_variables:
    - HVAC_electricity_demand_rate
  range_comfort_winter:
    - 18
    - 27
  range_comfort_summer:
    - 18
    - 27
  summer_start:
    - 6
    - 1
  summer_final:
    - 9
    - 30
  energy_weight: 0.5
  lambda_energy: 1.0e-4
  lambda_temperature: 1.0
